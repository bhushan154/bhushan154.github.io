<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/bootstrap.min.css" media="screen" />  
	<link rel="icon" type="image/x-icon" href="favicon.ico">	
	<style type="text/css">
		body { padding-bottom: 70px; padding-top: 70px;}
		.socials {padding-top: 15px;} 
	</style>
    <title>Jiradev.com: Your guide to Jira Plugin Development</title>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>	
  </head>

  <body>
	
		<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
				<div class="navbar-header"><a class="navbar-brand" href="index.html">Jiradev.com</a></div>
				
				<div class="collapse navbar-collapse navbar-ex1-collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="tutorials.html">Tutorials</a></li>
					<li><a href="aboutme.html">About me</a></li>					
				</ul>
				<ul class="nav navbar-nav pull-right">
					<li class="socials"><a href="https://twitter.com/share" class="twitter-share-button" data-url="www.jiradev.com" data-text="Check out jiradev.com. It's got simple tutorials for devs new to Jira Development" data-via="jiradev" data-hashtags="JIRA,atlassian">Tweet</a></li>					
				</ul>
				</div>
			</nav>
	
	
    <div class="container">
      <div class="row">
		<div class="col-md-12">
        <div class="page-header"><h4>Web Item Plugin Module</h4></div>
		
			<p>Let us get started with probably the most simple of all plugin modules. The web item plugin module. This allows us to add 
			links in different locations of the JIRA UI. We will add a link to the Atlassian Answers community page from two different locations.</p>
			
			<p><b>Adding a link to the top navigation bar</b></p>
			<p>
				<ol>
					<li>Start by creating a plugin skeleton. If you have not finished 
					the tutorial for creating a plugin skeleton, click <a href="plugin-skeleton.html">here</a>. Enter the information below.
						<div class="alert alert-info">
							<p>groupId: com.jiradev.jira.plugins</p>
							<p>artifactId: answers-webitem</p>
							<p>version: 1.0</p>
						</div>
					</li>
					<li>
						You should now have a new folder called answers-webitem. Within this folder, execute the command atlas-create-jira-plugin-module.<br /><br />
						<img class="img-thumbnail" src="images/lesson4/choose.png"/><br /><br />
					</li>
					<li>
						Select option 25 for Web-item and enter the info provided below.
						<div class="alert alert-info">
							<p>Enter plugin module name: Answers Link From Navigation</p>
							<p>Enter section: system.top.navigation.bar (<a href="https://developer.atlassian.com/display/JIRADEV/User+Accessible+Locations#UserAccessibleLocations-TopNavigationBarLocation">Refer to this link</a>)</p>
							<p>Enter link URL: https://answers.atlassian.com/</p>
							<p>Show advanced setup: N</p>
							<p>Add another plugin module: N</p>
						</div>
							<img class="img-thumbnail" src="images/lesson4/details.png"/><br /><br />
					</li>
					<li>Run the JIRA instance using the command atlas-run. You will now see the new link we just created.<br /><br />
							<img class="img-thumbnail" src="images/lesson4/link-without-login.png"/><br /><br /></li>
					<li>But what if we want to make the link visible only to users who are logged in? We can add conditions to web-items. Till
					this point, we did not have to make any changes to code or any of the data generated by Atlas SDK. But from this point on,
					using an IDE will make editing these files much easier. The <a href=""http://www.jetbrains.com/idea/>IntelliJ IDEA IDE</a> 
					has been my preferred IDE as it allows me to easily open projects and setup a remote debugger without any configuration.
					I will be using Idea throughout these tutorials. However, the Atlassian Developer site provides information to setup your IDE
					if you are using Eclipse or Netbeans. Have a look at the link <a href="https://developer.atlassian.com/display/DOCS/Set+Up+the+Eclipse+IDE+for+Windows">here</a>.</li>
				</ol>
				<p><b>Opening your project in IntelliJ Idea IDE</b></p>
				<ol>
					<li>Start the IDE and choose to "Open Project". Choose the pom.xml file from your project directory.
						<br /><br />
							<img class="img-thumbnail" src="images/lesson4/open-pom.png"/><br /><br />
					</li>
					<li>
						Let us take a quick look at the project structure. The src directory contains a folder called main. The main folder 
						contains two folders called java and resources. Java folder will contain all your source code. Resources folder will 
						contain javascript, images and mainly your <b>plugin definition file</b> named atlassian-plugin.xml.<br /><br />
							<img class="img-thumbnail" src="images/lesson4/atlassian-plugin.png"/><br /><br />
					</li>
					<li>Take a look at the atlassian-plugin.xml file. When you ran the atlas-create-jira-plugin-module command, the SDK 
					has created the definition of the web-item here for you.<br /><br />
							<img class="img-thumbnail" src="images/lesson4/original-atlassian-plugin.png"/><br /><br /></li>
					<li>You will also notice several other modules the atlas-create-jira-plugin command would have created as a sample. We do not
					require all these modules to be published as part of our plugin. Let us clean it up and keep only what is required. We are 
					interested only in the plugin-info, the i18N resource file and the web-item definition. 
					Cleanup the atlassian-plugin.xml. Below is a cleaned up version.
						<br /><br />
							<img class="img-thumbnail" src="images/lesson4/clean-atlassian-plugin.png"/><br /><br />
					</li>
				</ol>
			</p>
			
			<p><b>Making some changes to your plugin</b></p>
			<p>
				Great. So we now have an idea about the pom.xml and the atlassian-plugin.xml files. Let us continue making some changes to the 
				web-item we are working on. Firstly, the link is being displayed as "Atlassian link fron navigation". Let us change this to be
				displayed as "Atlassian Answers". Secondly, we will display it only to users who have logged into JIRA.
				<ol>
					<li>Open the atlassian-plugin.xml file and take a look at the web-item definition. The web-item has a label property. 
					These are defined in the file atlassian-webitem.properties file located in your resources folder. Open the properties file
					and look for the key being used by the label. ie, answers-link-from-navigation.label and update it's value to "Atlassian Answers".
					<br /><br />
							<img class="img-thumbnail" src="images/lesson4/props.png"/><br /><br /></li>
					<li>
						Now let us add a condition such that the link is displayed only to logged in users. Open the atlassian-plugin.xml and 
						add the condition. There are several conditions available. Click <a href="https://developer.atlassian.com/static/javadoc/jira/6.0.8/reference/com/atlassian/jira/plugin/webfragment/conditions/package-summary.html">here</a> to take a look.
						<br /><br />
							<img class="img-thumbnail" src="images/lesson4/condition.png"/><br /><br />
					</li>					
				</ol>
			</p>
			
			<p><b>Reloading your changes</b></p>
				<p>Once you have made changes to your plugin, you need to recompile and upload the plugin again. Atlassian SDK provides 
					two ways of doing this. Through the UI using FastDev or through command line using the atlas-cli command.</p>
				<p><u>Using Fastdev</u>				
				<ol>
					<li>On the bottom left corner of your running JIRA instance, you will find an option to expand the developer toolbar.<br /><br />
							<img class="img-thumbnail" src="images/lesson4/dev-tool-1.png"/><br /><br />Click on it to view the developer toolbar.</li>
					<li>On the right hand side of the developer toolbar, you will find the option to "Scan for changes to source code needing a recompile 
					then reload" option. Click to recompile and reload.<br /><br />
							<img class="img-thumbnail" src="images/lesson4/dev-tool-2.png"/><br /><br /></li>
				</ol>
				<p><u>Using command line</u>	
				<ol>
					<li>With the current command prompt where atlas-run is running being open, open a new instance of command prompt and
					change to your project directory.</li>
					<li>Run the atlas-cli command. When prompted with maven>, type "pi" and press enter. <br /><br />
							<img class="img-thumbnail" src="images/lesson4/atlas-cli.png"/><br /><br /></li>
				</ol>
			</p>
			
			<p>
			Awesome. You have just completed writing a web-item with a condition. You know about the directory structure of a JIRA plugin,
			the atlassian-plugin.xml file where the plugins are defined. Great first steps. In the next tutorial, we will take a look at web-sections 
			and place the same link under a web-section.			
			</p>
			<p>
			If you found this tutorial helpful, please show your support by tweeting about this tutorial. 
			<div><a href="https://twitter.com/intent/tweet?screen_name=jiradev&text=Woohoo.%20I%20completed%20the%20web-item%20tutorial%20on%20%40jiradev.%20%23atlassian%2C%20%23JIRA" class="twitter-mention-button" data-related="jiradev">Tweet to @jiradev</a></div>
			</p>
		</div>
	  </div>
    </div>

    <nav class="navbar navbar-default navbar-fixed-bottom">
		<div class="row">
			<div class="col-md-12">
				<p class="text-center">For more information about Jira Plugin Development and Training, contact <a href="mailto:bhushan154@gmail.com">Bhushan Nagaraj</a></p>
			</div>
		</div>
	</nav>
  </body>
</html>